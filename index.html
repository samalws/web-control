<p id="statusOtp"></p>
<button onclick="statusBtn()">Status</button>

<p id="cmdOtp"></p>
<input placeholder="cmd" id="cmdInput"></input>
<button onclick="cmdBtn()">Run</button>

<p id="wifiOtp"></p>
<input placeholder="ssid" id="ssidInput"></input>
<input type="password" placeholder="password" id="passInput"></input>
<button onclick="wifiBtn()">Wifi Login</button>

<script>
const request = (url, otp) => {
	requ = new XMLHttpRequest()
	requ.onload = () => otp(requ.response)
	requ.open("GET", url)
	requ.send()
}
const otp = (id) => (str) => {
	if (id == "") return
	document.getElementById(id + "Otp").innerHTML = str
}
const runCmd = (cmd, id) => {
	request("/cmd/" + cmd, otp(id))
}
const statusCmd = "date;echo '<br>';upower -d | grep percentage: | sed 's/percentage://' | sed '2,$d'"
const statusBtn = () => runCmd(statusCmd, "status")
const getInput = (id) => document.getElementById(id + "Input").value
const cmdBtn = () => runCmd(getInput("cmd"), "cmd")
const wifiCmd = () => {
	var cmd = "wpa_passphrase \'"
	cmd += getInput("ssid")
	cmd += "\' \'"
	cmd += getInput("pass")
	cmd += "\' | sudo tee /etc/wpa_supplicant.conf; "
	cmd += "sudo systemctl restart wpa_supplicant"
	return cmd
}
const wifiBtn = () => runCmd(wifiCmd(), "")
</script>
